IndexExpansion:
  messages:
    - role: user
      content: |
        # 指示
        以下の文章の内容について尋ねる質問文を{num_expands}個作成してください。

        # 注意事項
        - 単純な1つの事実を尋ねる質問文だけでなく、複数の事実から推論して答えなくてはならないような質問文も作成してください。
        - 10個の質問はカンマ区切りで出力してください。
        - 作成した質問文以外出力しないでください。

        # 出力形式
        質問1,質問2,質問3,...

        # 文章
        {text}

LLMRetrieving:
  messages:
    - role: user
      content: |
        # 設定
        小説の内容に関する質問を受けています。
        
        # 命令
        質問に答えるために必要な情報を、次の小説の部分的な情報の中から{top_k}個を選択して、出力してください。
        必要な情報がなさそうな場合であっても、最も必要な情報だと考えられる情報を必ず{top_k}個選択してください。
        出力はchunk_id(数字)のみを出力してください。
        
        # 情報のタイトル群
        chunk_id : question
        {novel_info}
        
        # 出力例
        4,3,6,2,~~

        【質問内容】
        {query}

GenerateStep1:
  messages:
    - role: user
      content: |
        # ユーザーの質問:
        {user_input}

        # ステップ 1: 質問を理解し、要点を抽出する
        ユーザーの質問は物語の内容に関するものです。
        ユーザーの質問や指示を正確に理解し、 回答するために実行すべきタスクを箇条書きで出力してください。

        # 回答するためのに実行すべきタスク:

GenerateStep2:
  messages:
    - role: user
      content: |
        # ステップ1: 質問を理解し、要点を抽出する
        回答するためのに実行すべきタスクは以下です。
        {step1_response}

        # ステップ 2: 問題解決のための考慮事項の検討
        ステップ 1 の内容に基づいて、問題解決のためのアプローチや必要な情報を検討します。

        # ステップ 2 の回答:

GenerateStep3:
  messages:
    - role: user
      content: |
        # ステップ2: 問題解決のための考慮事項の検討
        問題解決のためのアプローチや必要な情報は以下です。
        {step2_response}

        # ステップ 3: 初期回答の作成
        これまでの内容に基づいて、ユーザーの質問に対する初期回答を作成します。

        # 注意
        - あなたの情報は正確ではない可能性があります。物語の情報を必ず考慮してください。
        - 数量で答える問題の回答には単位を付けてください.
        - 参照元に答えの手がかりが見つからないと判断される場合はその旨を「分かりません」と答えてください.
        - 質問自体に誤りがあると判断される場合は「質問誤り」と答えてください.

        # 物語の情報:
        {novel_info}

        # 初期回答:

GenerateStep4:
  messages:
    - role: user
      content: |
        # ステップ 4: 振り返り（自己検証）
        初期回答がユーザーの質問や指示に正確に応答しているか確認し、誤りや改善点があれば指摘してください。
        指示を過剰解釈しないよう注意し、正確に理解できているかを慎重に評価してください。
        ユーザーの質問を再確認し、その質問自体に対する正確な回答を提供します。（質問自体に確実に回答することを確認します）

        # 注意
        - あなたの情報は正確ではない可能性があります。物語の情報を必ず考慮してください。
        - 数量で答える問題の回答には単位を付けてください.
        - 参照元に答えの手がかりが見つからないと判断される場合はその旨を「分かりません」と答えてください.
        - 質問自体に誤りがあると判断される場合は「質問誤り」と答えてください.

        # ユーザーの質問:
        {user_input}

        # 物語の情報:
        {novel_info}

        # 初期回答:
        {step3_response}

        # 振り返り結果:

GenerateStep5:
  messages:
    - role: user
      content: |
        # ステップ 5: 最終回答の作成
        振り返り結果に基づいて、初期回答を必要に応じて修正します。
        ユーザーの質問を再確認し、過剰解釈、誤解、抜け漏れ、または不注意によるミスがないかを確認します。
        これらを反映して、最終回答を作成します。

        # 注意
        - あなたの情報は正確ではない可能性があります。物語の情報を必ず考慮してください。
        - 数量で答える問題の回答には単位を付けてください.
        - 参照元に答えの手がかりが見つからないと判断される場合はその旨を「分かりません」と答えてください.
        - 質問自体に誤りがあると判断される場合は「質問誤り」と答えてください.
        - 40文字以内で簡潔に答えてください。

        # 初期回答:
        {step3_response}

        # 振り返り結果:
        {reflection_response}

        # 物語の情報:
        {novel_info}

        # ユーザーの質問:
        {user_input}
        ユーザーの質問に対する最終回答を提供してください。

        # 最終回答:

Reasoning:
  messages:
    - role: user
      content: |
        あなたの回答の根拠を示してください。
        ユーザーの質問に対して、物語の情報を参照した結果、以下の回答が得られました。
        そう判断した理由を出力してください。

        # ユーザーの質問:
        {user_input}
        ユーザーの質問に対する最終回答を提供してください。

        # 物語の情報:
        {novel_info}

        # あなたの回答:
        {final_response}
